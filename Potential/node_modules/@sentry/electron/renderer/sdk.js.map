{"version":3,"file":"sdk.js","sources":["../src/src/renderer/sdk.ts"],"sourcesContent":["/* eslint-disable no-restricted-globals */\nimport {\n  BrowserOptions,\n  getDefaultIntegrations as getDefaultBrowserIntegrations,\n  init as browserInit,\n} from '@sentry/browser';\nimport { Integration } from '@sentry/types';\nimport { logger } from '@sentry/utils';\n\nimport { RendererProcessAnrOptions } from '../common/ipc';\nimport { enableAnrRendererMessages } from './anr';\nimport { scopeToMainIntegration } from './integrations/scope-to-main';\nimport { electronRendererStackParser } from './stack-parse';\nimport { makeRendererTransport } from './transport';\n\n/** Get the default integrations for the renderer SDK. */\nexport function getDefaultIntegrations(options: ElectronRendererOptions): Integration[] {\n  return [...getDefaultBrowserIntegrations(options), scopeToMainIntegration()];\n}\n\ninterface ElectronRendererOptions extends BrowserOptions {\n  /**\n   * Enables ANR detection in this renderer process.\n   *\n   * Optionally accepts an object of options to configure ANR detection.\n   *\n   * {\n   *   pollInterval: number; // Defaults to 1000ms\n   *   anrThreshold: number; // Defaults to 5000ms\n   *   captureStackTrace: boolean; // Defaults to false\n   * }\n   *\n   * Defaults to 'false'.\n   */\n  anrDetection?: Partial<RendererProcessAnrOptions> | boolean;\n}\n\n/**\n * Initialize Sentry in the Electron renderer process\n * @param options SDK options\n * @param originalInit Optional init function for a specific framework SDK\n * @returns\n */\nexport function init<O extends ElectronRendererOptions>(\n  options: ElectronRendererOptions & O = {} as ElectronRendererOptions & O,\n  // This parameter name ensures that TypeScript error messages contain a hint for fixing SDK version mismatches\n  originalInit: (if_you_get_a_typescript_error_ensure_sdks_use_version_v8_35_0: O) => void = browserInit,\n): void {\n  // Ensure the browser SDK is only init'ed once.\n  if (window?.__SENTRY__RENDERER_INIT__) {\n    logger.warn(`The browser SDK has already been initialized.\nIf init has been called in the preload and contextIsolation is disabled, is not required to call init in the renderer`);\n    return;\n  }\n\n  window.__SENTRY__RENDERER_INIT__ = true;\n\n  // We don't want browser session tracking enabled by default because we already have Electron\n  // specific session tracking from the main process.\n  if (options.autoSessionTracking === undefined) {\n    options.autoSessionTracking = false;\n  }\n\n  // Disable client reports for renderer as the sdk should only send\n  // events using the main process.\n  options.sendClientReports = false;\n\n  if (options.defaultIntegrations === undefined) {\n    options.defaultIntegrations = getDefaultIntegrations(options);\n  }\n\n  if (options.stackParser === undefined) {\n    options.stackParser = electronRendererStackParser;\n  }\n\n  if (options.dsn === undefined) {\n    // Events are sent via the main process but browser SDK wont start without dsn\n    options.dsn = 'https://12345@dummy.dsn/12345';\n  }\n\n  if (options.transport === undefined) {\n    options.transport = makeRendererTransport;\n  }\n\n  if (options.anrDetection) {\n    enableAnrRendererMessages(options.anrDetection === true ? {} : options.anrDetection);\n  }\n\n  // We only handle initialScope in the main process otherwise it can cause race conditions over IPC\n  delete options.initialScope;\n\n  originalInit(options);\n}\n"],"names":["getDefaultBrowserIntegrations","scopeToMainIntegration","browserInit","logger","electronRendererStackParser","makeRendererTransport","enableAnrRendererMessages"],"mappings":";;;;;;;AAAA;AAeA;AACM,SAAU,sBAAsB,CAAC,OAAgC,EAAA;IACrE,OAAO,CAAC,GAAGA,8BAA6B,CAAC,OAAO,CAAC,EAAEC,kCAAsB,EAAE,CAAC;AAC9E;AAmBA;;;;;AAKG;AACa,SAAA,IAAI,CAClB,OAAA,GAAuC,EAAiC;AACxE;AACA,YAAA,GAA2FC,YAAW,EAAA;;IAGtG,IAAI,MAAM,EAAE,yBAAyB,EAAE;QACrCC,YAAM,CAAC,IAAI,CAAC,CAAA;AACsG,qHAAA,CAAA,CAAC;QACnH;AACD;AAED,IAAA,MAAM,CAAC,yBAAyB,GAAG,IAAI;;;AAIvC,IAAA,IAAI,OAAO,CAAC,mBAAmB,KAAK,SAAS,EAAE;AAC7C,QAAA,OAAO,CAAC,mBAAmB,GAAG,KAAK;AACpC;;;AAID,IAAA,OAAO,CAAC,iBAAiB,GAAG,KAAK;AAEjC,IAAA,IAAI,OAAO,CAAC,mBAAmB,KAAK,SAAS,EAAE;AAC7C,QAAA,OAAO,CAAC,mBAAmB,GAAG,sBAAsB,CAAC,OAAO,CAAC;AAC9D;AAED,IAAA,IAAI,OAAO,CAAC,WAAW,KAAK,SAAS,EAAE;AACrC,QAAA,OAAO,CAAC,WAAW,GAAGC,sCAA2B;AAClD;AAED,IAAA,IAAI,OAAO,CAAC,GAAG,KAAK,SAAS,EAAE;;AAE7B,QAAA,OAAO,CAAC,GAAG,GAAG,+BAA+B;AAC9C;AAED,IAAA,IAAI,OAAO,CAAC,SAAS,KAAK,SAAS,EAAE;AACnC,QAAA,OAAO,CAAC,SAAS,GAAGC,+BAAqB;AAC1C;IAED,IAAI,OAAO,CAAC,YAAY,EAAE;AACxB,QAAAC,6BAAyB,CAAC,OAAO,CAAC,YAAY,KAAK,IAAI,GAAG,EAAE,GAAG,OAAO,CAAC,YAAY,CAAC;AACrF;;IAGD,OAAO,OAAO,CAAC,YAAY;IAE3B,YAAY,CAAC,OAAO,CAAC;AACvB;;;;;"}